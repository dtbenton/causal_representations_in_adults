scale_fill_manual(values = c("red", "blue", "green", "black")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = measure)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values = c("red", "blue", "green", "black")) +
theme_classic()
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = measure)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)")
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = measure)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, color = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
+scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9", "black")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "red") + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9", "black")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = c("red","blue","green","yellow")) + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9", "black")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = c("red","blue","green","yellow")) + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("white", "white", "white", "white")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = c("#999999", "#E69F00", "#56B4E9","black")) + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("white", "white", "white", "white")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
nrow(D_tall)
D_tall$indiv_dif = rep(0,nrow(D_tall))
print("1",quote=FALSE)
D_tall$indiv_dif = rep(0,nrow(D_tall))
for(i in 1:length(D_tall$indiv_dif)){
if(D_tall$measure[D_tall$test_trials=="gBgR"]>D_tall$measure[D_tall$test_trials=="gBRg"] &
D_tall$measure[D_tall$test_trials=="gBgR"]>D_tall$measure[D_tall$test_trials=="gRBg"]){
D_tall$indiv_dif[i] = print("1",quote=FALSE)
} else{
D_tall$indiv_dif[i] = print("0",quote=FALSE)
}
}
D_tall$indiv_dif = rep(0,nrow(D_tall))
for(i in 1:length(D_tall$indiv_dif)){
if(D_tall$measure[D_tall$test_trials=="gBgR"]>D_tall$measure[D_tall$test_trials=="gBRg"] &
D_tall$measure[D_tall$test_trials=="gBgR"]>D_tall$measure[D_tall$test_trials=="gRBg"]){
D_tall$indiv_dif[i] = noquote(1)
} else{
D_tall$indiv_dif[i] = noquote(0)
}
}
D_tall$indiv_dif
D_tall$indiv_dif = rep(0,nrow(D_tall))
for(i in 1:length(D_tall$indiv_dif)){
if(D_tall$measure[D_tall$test_trials=="gBgR"]>D_tall$measure[D_tall$test_trials=="gBRg"] &
D_tall$measure[D_tall$test_trials=="gBgR"]>D_tall$measure[D_tall$test_trials=="gRBg"]){
D_tall$indiv_dif[i] = 1
} else{
D_tall$indiv_dif[i] = 0
}
}
D_tall$indiv_dif
D_tall$measure[D_tall$test_trials][1]
D_tall$indiv_dif = rep(0,nrow(D_tall))
for(i in 1:length(D_tall$indiv_dif)){
if(D_tall$measure[D_tall$test_trials=="gBgR"][i]>D_tall$measure[D_tall$test_trials=="gBRg"][i] &
D_tall$measure[D_tall$test_trials=="gBgR"][i]>D_tall$measure[D_tall$test_trials=="gRBg"][i]){
D_tall$indiv_dif[i] = 1
} else{
D_tall$indiv_dif[i] = 0
}
}
D_tall$measure[D_tall$test_trials=="gBgR"][1]
D_tall$measure[D_tall$test_trials=="gBgR"][10]
D_tall$measure[D_tall$test_trials=="gBgR"][15]
D_tall$measure[D_tall$test_trials=="gBgR"][155]
length(D_tall$measure[D_tall$test_trials])
names(D)
fix(D_tall)
D_tall$measure[D_tall$test_trials=="gBgR"]
D_tall$measure[D_tall$test_trials=="gBgR"][1]
D_tall$measure[D_tall$test_trials=="gRgB"][1]
D_tall$measure[D_tall$test_trials=="gRgB"][256]
512/4
D_tall$measure[D_tall$test_trials=="gRgB"][128]
D_tall$measure[D_tall$test_trials=="gRgB"][129]
D_tall$indiv_dif = rep(0,nrow(D_tall))
for(i in 1:length(D_tall$indiv_dif)){
if(D_tall$measure[D_tall$test_trials=="gBgR"][i]>D_tall$measure[D_tall$test_trials=="gBRg"][i]&
D_tall$measure[D_tall$test_trials=="gBgR"][i]>D_tall$measure[D_tall$test_trials=="gRBg"][i]&
D_tall$measure[D_tall$test_trials=="gRgB"][i]>D_tall$measure[D_tall$test_trials=="gBRg"][i]&
D_tall$measure[D_tall$test_trials=="gRgB"][i]>D_tall$measure[D_tall$test_trials=="gRBg"][i]){
D_tall$indiv_dif[i] = 1
}else{
D_tall$indiv_dif[i] = 0
}
}
D_tall$indiv_dif = rep(0,nrow(D_tall))
for(i in 1:length(D_tall$indiv_dif)){
if(D_tall$measure[D_tall$test_trials=="gBgR"][i]>D_tall$measure[D_tall$test_trials=="gBRg"][i]&
D_tall$measure[D_tall$test_trials=="gBgR"][i]>D_tall$measure[D_tall$test_trials=="gRBg"][i]&
D_tall$measure[D_tall$test_trials=="gRgB"][i]>D_tall$measure[D_tall$test_trials=="gBRg"][i]&
D_tall$measure[D_tall$test_trials=="gRgB"][i]>D_tall$measure[D_tall$test_trials=="gRBg"][i]){
print("1")
}else{
print("0")
}
}
head(D_tall$indiv_dif)
dim(D_tall$indiv_dif)
fd = 1
fd
512/4
##################################
# INDIVIDUAL DIFFERENCE ANALYSIS #
##################################
D_tall$measure[D_tall$test_trials=="gBgR"][1]>D_tall$measure[D_tall$test_trials=="gBRg"][1]
D_tall$measure[D_tall$test_trials=="gBgR"]
D_tall$measure[D_tall$test_trials=="gBgR"][1]
D_tall$measure[D_tall$test_trials=="gBRg"][1]
length(D_tall$measure[D_tall$test_trials])
512/60
512/64
fix(D_tall)
names(D)
mean(D$gbgr.perceptual.rating+gbgr.causal.rating)
mean(D$gbgr.perceptual.rating+D$gbgr.causal.rating)
mean(D$gbgr.perceptual.rating[1]+D$gbgr.causal.rating[1])
fix(D)
D$gbgr.causal.rating[1]
D$gbgr.causal.rating[1]+D$gbgr.perceptual.rating[1]
mean(mean(D$gbgr.perceptual.rating[1]+D$gbgr.causal.rating[1]))
130/2
sfs = D$gbgr.perceptual.rating[1]+D$gbgr.causal.rating[1]
sfs
mean(sfs)
mean(c(D$gbgr.perceptual.rating[1],D$gbgr.causal.rating[1]))
##################################
# INDIVIDUAL DIFFERENCE ANALYSIS #
##################################
F = D
nrow(D)
names(D)
for(i in 1:64){
if(mean(c(D$gbgr.perceptual.rating[i],D$gbgr.causal.rating[i]))>mean(c(D$gbrg.perceptual.rating[i],D$gbrg.causal.rating[i]))&
mean(c(D$gbgr.perceptual.rating[i],D$gbgr.causal.rating[i]))>mean(c(D$grbg.perceptual.rating[i],D$grbg.causal.rating[i]))&
mean(c(D$grgb.perceptual.rating[i],D$grgb.causal.rating[i]))>mean(c(D$gbrg.perceptual.rating[i],D$gbrg.causal.rating[i]))&
mean(c(D$grgb.perceptual.rating[i],D$grgb.causal.rating[i]))>mean(c(D$grbg.perceptual.rating[i],D$grbg.causal.rating[i]))){
print("1")
}else{
print("0")
}
}
B$ind_dif = rep(0,nrow(D))
for(i in 1:64){
if(mean(c(D$gbgr.perceptual.rating[i],D$gbgr.causal.rating[i]))>mean(c(D$gbrg.perceptual.rating[i],D$gbrg.causal.rating[i]))&
mean(c(D$gbgr.perceptual.rating[i],D$gbgr.causal.rating[i]))>mean(c(D$grbg.perceptual.rating[i],D$grbg.causal.rating[i]))&
mean(c(D$grgb.perceptual.rating[i],D$grgb.causal.rating[i]))>mean(c(D$gbrg.perceptual.rating[i],D$gbrg.causal.rating[i]))&
mean(c(D$grgb.perceptual.rating[i],D$grgb.causal.rating[i]))>mean(c(D$grbg.perceptual.rating[i],D$grbg.causal.rating[i]))){
B$ind_dif[i] = 1
}else{
B$ind_dif[i] = 0
}
}
B = D
B$ind_dif = rep(0,nrow(B))
for(i in 1:64){
if(mean(c(B$gbgr.perceptual.rating[i],B$gbgr.causal.rating[i]))>mean(c(B$gbrg.perceptual.rating[i],B$gbrg.causal.rating[i]))&
mean(c(B$gbgr.perceptual.rating[i],B$gbgr.causal.rating[i]))>mean(c(B$grbg.perceptual.rating[i],B$grbg.causal.rating[i]))&
mean(c(B$grgb.perceptual.rating[i],B$grgb.causal.rating[i]))>mean(c(B$gbrg.perceptual.rating[i],B$gbrg.causal.rating[i]))&
mean(c(B$grgb.perceptual.rating[i],B$grgb.causal.rating[i]))>mean(c(B$grbg.perceptual.rating[i],B$grbg.causal.rating[i]))){
B$ind_dif[i] = 1
}else{
B$ind_dif[i] = 0
}
}
dim(B)
names(D)
names(B)
fix(B)
(D$gbgr.perceptual.rating+D$gbgr.causal.rating)/2
(D$gbgr.perceptual.rating[1]+D$gbgr.causal.rating[1])/2
fix(B)
table(B$ind_dif)
fix(B)
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = c("#999999", "#E69F00", "#56B4E9","black")) + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("white", "white", "white", "white")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
theme(strip.text = element_text(colour = 'black', size = 12)) + # this changes the size and potentially weight of the facet labels
theme(axis.title=element_text(size="12"),axis.text=element_text(size=12)) +
theme(legend.box.background = element_rect(), legend.box.margin = margin(6, 6, 6, 6)) +
theme(legend.text = element_text(size = 12)) +
annotate("segment", x=-Inf, xend=Inf, y=-Inf, yend=-Inf) + # this adds a vertical & horizontal line to each plot
annotate("segment", x=-Inf, xend=-Inf, y=-Inf, yend=Inf) + # ditto
theme(legend.title=element_blank()) +
labs(x = "Test trials")
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = c("#999999", "#E69F00", "#56B4E9","black")) + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("white", "white", "white", "white")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)
theme(strip.text = element_text(colour = 'black', size = 12)) + # this changes the size and potentially weight of the facet labels
theme(axis.title=element_text(size="12"),axis.text=element_text(size=12)) +
theme(legend.box.background = element_rect(), legend.box.margin = margin(6, 6, 6, 6)) +
theme(legend.text = element_text(size = 12)) +
theme(legend.title=element_blank()) +
labs(x = "Test trials")
condition_barplot = ggplot(D_tall, aes(test_trials, measure, fill = test_trials)) # create the bar graph with test.trial.2 on the x-axis and measure on the y-axis
condition_barplot + stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = c("#999999", "#E69F00", "#56B4E9","black")) + # add the bars, which represent the means and the place them side-by-side with 'dodge'
stat_summary(fun.data=mean_cl_boot, geom = "errorbar", position = position_dodge(width=0.90), width = 0.2) + # add errors bars
ylab("ratings (scale: 0-100)") + # change the label of the y-axis
theme_bw() + # remove the gray background
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + # remove the major and minor grids
scale_y_continuous(expand = c(0, 0)) + # ensure that bars hit the x-axis
coord_cartesian(ylim=c(0, 100)) +
scale_fill_manual(values=c("white", "white", "white", "white")) +
theme_classic() +
geom_signif(comparisons = list(c("gBgR", "gBRg")),
annotations=c("p < .0001"), y_position = 95, tip_length = 0.03) +
geom_signif(comparisons = list(c("gBgR", "gRBg")),
annotations=c("p < .0001"),
y_position = 85, tip_length = 0.03)+
theme(strip.text = element_text(colour = 'black', size = 12)) + # this changes the size and potentially weight of the facet labels
theme(axis.title=element_text(size="12"),axis.text=element_text(size=12)) +
theme(legend.box.background = element_rect(), legend.box.margin = margin(6, 6, 6, 6)) +
theme(legend.text = element_text(size = 12)) +
theme(legend.title=element_blank()) +
labs(x = "Test trials")
rm(list=ls())
library(lme4)
library(nlme)
library(boot)
library(car)
library(reshape2)
library(ggplot2)
library(ez)
library(plyr)
library(ggsignif)
library(lsr)
library(sjmisc)
library(sjstats)
library(BayesFactor)
library(foreign)
library(dplyr)
library(lattice)
library(openxlsx)
options(scipen=9999)
# load data
D = read.csv(file.choose(), header = TRUE)
dim(D)
D = as.data.frame(D[,c(1,2,3,9,5,7,4,10,6,8,11,12)])
# reshape the data
D_tall = reshape(D, varying = 3:10, v.names = "measure", timevar = "condition",
idvar = "ID",
new.row.names = 1:512, direction = "long")
# order data
D_tall = D_tall[order(D_tall$ID),]
# convert all categorical variables to 'factors'
D_tall$q.type.cat = as.factor(rep(c(0,1), each = 4, times = 64))
D_tall$q.type.cat = revalue(x = as.factor(D_tall$q.type.cat),
c("0"="Perceptual", "1"="Causal"))
D_tall$q.type = revalue(x = as.factor(D_tall$q.type),
c("0" = "Perceptual_First",
"1"="Causal_First")) # this corresponds to whether participants
# were asked the causal or perceptual question
# first.
D_tall$exp = revalue(x = as.factor(D_tall$exp),
c("0" = "Kaily", "1" = "Marina"))
D_tall$group = revalue(x = as.factor(D_tall$group),
c("0" = "Red", "1" = "Blue"))
D_tall$test_trials = as.factor(rep(c(1:4), each = 1,
times = 128))
D_tall$test_trials = revalue(x = as.factor(D_tall$test_trials),
c("1" = "gBgR", "2" = "gRgB",
"3" = "gBRg", "4" = "gRBg"))
# drop unnecessary columns and reorder 'D_tall'
D_tall$row.names = NULL
D_tall$condition = NULL
D_tall = D_tall[,c(1,2,4,3,6,7,5)]
names(D_tall)
dim(D_tall)
main_boot = function(a,x,y){
set.seed(2020)
trees_estimate = function(data, indices) {
d = data[indices,]
mean_height = mean(d[d[,x]==a,y])
return (mean_height)
}
compute_boot = boot(D_tall,trees_estimate,R=4000)
return(c(compute_boot$t0,compute_boot$t0 + 1.96*c(-sd(compute_boot$t),
sd(compute_boot$t))))
}
# example: main_boot("Perceptual",5,7)
perm_func = function(data_1,data_2,x,y){
c = rep(0,10000)
for(i in 1:length(c)){
set.seed(2020)
sample_y = sample(data_1)
vec_1 = sample_y[data_2==x]
vec_2 = sample_y[data_2==y]
dif = vec_1 - vec_2
c[i] = mean(dif)
}
bb_dif = mean(data_1[data_2==x]-data_1[data_2==y])
c(mean(c),bb_dif,sum(abs(c) > bb_dif)/length(c),sum(abs(c) < bb_dif)/length(c),
mean(data_1[data_2==x]),mean(data_1[data_2==y]))
}
